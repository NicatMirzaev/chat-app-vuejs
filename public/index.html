</<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Chat App</title>
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <div id="app">
      <form v-if="screen === 1" class="form" @submit="onSubmit">
        <img width="80" height="80" src="./assets/user.svg" alt="user icon"></img>
        <input class="input" type="text" id="username" name="username" v-model="username" placeholder="Please enter your username" required></input>
        <input class="input" type="text" id="room" name="room" v-model="room" placeholder="Please enter room name" required></input>
        <p style="color:red;margin-top:15px;" v-if="error.length > 0">{{ error }}</p>
        <button class="button">Join</button>
      </form>
      <div v-if="screen === 2" class="chat-container">
        <div style="margin-right: 20px; flex:0.3;">
          <div class="users">
            <span class="text">Users (2 online)</span>
            <ul class="user-list">
              <li class="user-item">Nicat</li>
              <li class="user-item">Ejder</li>
              <li class="user-item">Testtt</li>
              <li class="user-item">Testtt</li>
              <li class="user-item">Testtt</li>
              <li class="user-item">Testtt</li>
            </ul>
          </div>
      </div>
        <div class="chat">
          <div class="chat-header">
            <span class="room-text">Developer Room</span>
            <img style="cursor:pointer; margin-right:10px;" width="18" height="18" src="./assets/log-out.svg" alt="leave room"></img>
          </div>
          <div class="messages">
            <ul class="messages-list">
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz bende iyiyim amk gel ksjadjsa test test test test test test test test test</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz bende iyiyim amk gel ksjadjsa test test test test test test test test test</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz bende iyiyim amk gel ksjadjsa test test test test test test test test test</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz bende iyiyim amk gel ksjadjsa test test test test test test test test test</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz bende iyiyim amk gel ksjadjsa test test test test test test test test test</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz bende iyiyim amk gel ksjadjsa test test test test test test test test test</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz bende iyiyim amk gel ksjadjsa test test test test test test test test test</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
              <li class="message"><span class="username">Nicat:</span> <span class="message-content">Merhabalar, nasılsınız iyi misiniz?</span><li>
            </ul>
          </div>
          <div class="send-message">
            <input style="margin: 10px; width:80%;"class="input" placeholder="Write your message.."></input>
            <button class="button">Send</button>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script src="https://unpkg.com/vue@next"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io('http://localhost:3000');
    const App = {
      data () {
        return {
          error: '',
          username: '',
          room: '',
          screen: 2
        }
      },
      methods: {
        onSubmit: function (event) {
          event.preventDefault();
          socket.emit('join-room', {username: this.username, room: this.room})
          socket.on('join-room', data => {
            if(data.error.length > 0) {
              this.error = data.error;
            }
            else {
              this.screen = 2
            }
          })
        }
      },
    }
    Vue.createApp(App).mount('#app')
  </script>
</html>
